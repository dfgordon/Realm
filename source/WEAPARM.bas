 3720  TEXT: HOME: PRINT "PLACING: ";B$: PRINT NM$(A);"'S ";: GOSUB 4210
 3730  PRINT: PRINT "USE ARROWS TO CHANGE CHARACTER": PRINT "1-8 REPLACES, ESC ABORTS ": GET A$
 3740  IF A$ = CHR$(27) THEN PRINT: PRINT "SALE ABORTED! ";: GET A$: RETURN
 3741  IF A$ = CHR$(8) THEN A = A - 1: GOTO 3790
 3742  IF A$ = CHR$(21) THEN A = A + 1: GOTO 3790
 3743  I = VAL(A$) - 1: IF I<0 OR I>7 THEN 3790
 3760 AP$(A,I) =  LEFT$ (B$ + " ", LEN (B$)): AD% = AD% - C: GOSUB 7100: PRINT: PRINT "SALE COMPLETE! ";: GET A$: RETURN
 3790  IF A<0 THEN A = 0
 3791  IF A>3 THEN A = 3
 3792  GOTO 3720

 4210  PRINT "ITEMS:": FOR I = 0 TO 7: PRINT I + 1;") ";: PRINT AP$(A,I): NEXT: RETURN

 4300  PRINT "FOR SALE:"
 4310  P = 1: N = 8: IF M = 15 THEN P = 10: N = 12
 4320  IF T$="SULPHUR CITY" AND M = 10 THEN N = 9
 4330  FOR I = P TO N
 4340  ON I GOSUB 20000,20010,20020,20030,20040,20050,20060,20070,20080,20100,20110,20120
 4345  GOSUB 19000
 4350  PRINT I+1-P;") ";B$;" (";C;")"
 4360  NEXT I
 4370  RETURN

 7100 I = 0
 7105  FOR P = 0 TO 7: IF DW$(A) = AP$(A,P) THEN I = 8
 7106  NEXT : IF I = 0 THEN DW$(A) = "HA"+"NDS"
 7109 I = 0
 7110  FOR P = 0 TO 7: IF DV$(A) = AP$(A,P) THEN I = 8
 7111  NEXT : IF I = 0 THEN DV$(A) = "SK"+"IN"
 7115  RETURN

 8900  REM

 9500  HOME : VTAB 21: PRINT "CHARACTER TO TRANSACT (#) ";: GET A$:A =  VAL (A$) - 1: IF A < 0 OR A > 3 THEN 9500
 9501  IF AB%(A) = 0 THEN 9500
 9510  TEXT: HOME: PRINT "WELCOME TO THE ";
 9511  IF M = 10 THEN PRINT "WEAPONS SHOP:"
 9512  IF M = 15 THEN PRINT "ARMOURY:"
 9520  GOSUB 4300
 9530  PRINT "GOLD: ";AD%;"- BUY (#) OR LEAVE (ESC): ";: GET A$: IF A$ = CHR$(27) THEN 25000
 9540  I = P+VAL(A$)-1: IF I<P OR I>N THEN 9510
 9550  ON I GOSUB 20000,20010,20020,20030,20040,20050,20060,20070,20080,20100,20110,20120

 9560  GOSUB 19000: IF AD% < C THEN PRINT: PRINT "YOU DON'T HAVE THE GOLD! ";: GOSUB 30050: GOTO 9510
 9670  L = A: GOSUB 3720: A = L: GOTO 9510

 19000 C = INT (C * (1 - AK%(A) / 100)): RETURN

 20000 C = 30: B$ = "DAGGER": RETURN
 20010 C = 80: B$ = "AXE": RETURN
 20020 C = 70: B$ = "MACE": RETURN
 20030 C = 100: B$ = "MORNING STAR": RETURN
 20040 C = 120: B$ = "BOW": RETURN
 20050 C = 200: B$ = "LONGSWORD": RETURN
 20060 C = 340: B$ = "BROADSWORD": RETURN
 20070 C = 500: B$ = "2H SWORD": RETURN
 20080 C = 2000: B$ = "SWORD OF LIGHT": RETURN
 20100 C = 90: B$ = "LEATHER": RETURN
 20110 C = 180: B$ = "CHAIN": RETURN
 20120 C = 400: B$ = "PLATE": RETURN

 25000  POKE -16304,0: POKE 16384,0: POKE 103,1: POKE 104,64: GOTO 25000

 30050  POKE 8191,50: CALL 912: GET A$: RETURN
