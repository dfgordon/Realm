1  ZA% =  ZA%(A) / 1000: RESTORE: FOR I=0 TO CL%(A): READ DM: NEXT
2  DM = (ZA%+2) * (DM + A%(4)): IF DM > 3000 THEN DM = 3000
3  RETURN
4  DATA 60,100,80,80,80,60,50

100  POKE 16384,0: POKE 103,1: POKE 104,64: GOTO 100

350  ON I+1 GOTO 351,352,353,354,355,356
351  PRINT "STRENGTH";: RETURN
352  PRINT "INTELLIGENCE";: RETURN
353  PRINT "WISDOM";: RETURN
354  PRINT "AGILITY";: RETURN
355  PRINT "STAMINA";: RETURN
356  PRINT "CHARISMA";: RETURN

360  C = AD%: A%(0)=AF%(A): A%(1)=AG%(A): A%(2)=AH%(A): A%(3)=AI%(A): A%(4)=AJ%(A): A%(5)=AK%(A)
361  TEXT: HOME: PRINT "BUY ABILITIES:": PRINT: FOR I = 0 TO 5: GOSUB 350: PRINT ": ";A%(I): NEXT: PRINT: PRINT "GOLD: ";AD%: PRINT "HP: ";DM
364  M = 0: N = 0: P = 5: GOSUB 380: IF A$ = CHR$(27) THEN AD% = C: HTAB 1: VTAB 14: PRINT "TRAINING ABORTED! ";: GET A$: RETURN
365  AB%(A) = DM: AC%(A) = DM: AF%(A) = A%(0): AG%(A) = A%(1): AH%(A) = A%(2): AI%(A) = A%(3): AJ%(A) = A%(4): AK%(A) = A%(5): RETURN

370  L = 0: IF A$ = CHR$(8) THEN L = - 1
371  IF A$ = CHR$(21) THEN L = 1
372  IF A$ = "A" OR A$ = CHR$(11) THEN N = M: M = M - 1: IF M<0 THEN M = P
373  IF A$ = "Z" OR A$ = CHR$(10) THEN N = M: M = M + 1: IF M>P THEN M = 0
374  RETURN

380  VTAB 13: PRINT "ARROWS/A/Z, ENTER, ESC- "
381  HTAB 1: VTAB N+3: I=N: GOSUB 350: PRINT ": ";A%(I);TAB(38): INVERSE: HTAB 1: VTAB M+3: I=M: GOSUB 350: NORMAL: PRINT ": ";A%(I);TAB(38)
382  HTAB 7: VTAB 10: PRINT AD%;TAB(38): HTAB 5: VTAB 11: PRINT DM;TAB(38): HTAB 25: VTAB 13: GET A$: GOSUB 370: IF A$ = CHR$(27) OR A$ = CHR$(13) THEN RETURN
383  A%(M) = A%(M) + L: AD% = AD% - L*100: IF A%(M) < 5 OR A%(M) > 60 OR AD% < 0 OR AD% > C THEN L = L*-1: GOTO 383
384  GOSUB 1: GOTO 381

400  HOME: VTAB 21: PRINT "-MAGIC STRIKES YOU-": GOSUB 30000
410  PRINT NM$(A);" READY TO TRAIN- ";: GET A$: GOSUB 360: POKE -16304,0: HOME: VTAB 21: RETURN

8910  GET A$
8920  FOR A = 0 TO 3
8930  IF AB%(A) > 0 THEN A%(4)=AJ%(A): GOSUB 1: IF DM > AC%(A) THEN GOSUB 400
8940  NEXT: HOME: GOTO 100

30000  POKE 6,64: POKE 7,2: POKE 8,100: POKE 9,1: POKE 30,2: CALL 806: RETURN
