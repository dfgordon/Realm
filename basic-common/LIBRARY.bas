10 ON I GOTO 11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26
11 C = 50:A$ = "PHANTOM ARROW": RETURN
12 C = 75:A$ = "FIREBALL": RETURN
13 C = 75:A$ = "LIGHTNING BOLT": RETURN
14 C = 100:A$ = "RADIATION CONE": RETURN
15 C = 200:A$ = "ICE STORM": RETURN
16 C = 300:A$ = "BOMBARDMENT": RETURN
17 C = 60:A$ = "SLEEP": RETURN
18 C = 60:A$ = "STONE": RETURN
19 C = 80:A$ = "PARALYZE": RETURN
20 C = 175:A$ = "DOOM ARROW": RETURN
21 C = 250:A$ = "DISINTEGRATE": RETURN
22 C = 450:A$ = "KILL": RETURN
23 C = 50:A$ = "KNOCK": RETURN
24 C = 200:A$ = "PASSWALL": RETURN
25 C = 400:A$ = "FLY": RETURN
26 C = 100:A$ = "SHIELD": RETURN

27 PRINT "LEARNED:";TAB(16);"SPELLS (M.U.):"
28 PRINT "--------";TAB(16);"--------------"
29 FOR I = 1 TO 16: GOSUB 10: PRINT LEFT$(AX$(A,I-1),14);TAB(16);: IF I=1 THEN INVERSE
30 PRINT A$;: NORMAL: PRINT " (";C;")": NEXT
31 RETURN

33 TEXT : HOME : PRINT "WELCOME TO THE LIBRARY, ";NM$(A)
34 PRINT : PRINT "ONE MOMENT WHILE I FILE THINGS...": FOR P = 0 TO EP: NEXT P
35 P = 0: M =  FRE (0)
36 FOR I = 0 TO 15:AX$(A,I) = "": NEXT
37 M =  FRE (0):WT% =  INT (ZA%(A) / 1000) * 100 + 100:WT% = WT% + (WT% * (AG%(A) / 100))
38 IF CL$(A) = "RANGER" THEN WT% = WT% / 2

40 HOME: GOSUB 27: I = 1
41 VTAB 20: HTAB 1: PRINT "MAGIC UNITS: ";WT%;"- ARROWS, ENTER, ESC: ";: CALL -868: GET A$: IF A$ = CHR$(27) THEN 62
42 L = 0: IF A$ = CHR$(13) THEN GOSUB 10: GOTO 49
43 IF A$ = CHR$(8) OR A$ = CHR$(11) THEN L = -1
44 IF A$ = CHR$(10) OR A$ = CHR$(21) THEN L = 1
45 GOSUB 10: HTAB 16: VTAB 2+I: PRINT A$: I = I + L
46 IF I<1 THEN I=16
47 IF I>16 THEN I=1
48 GOSUB 10: HTAB 16: VTAB 2+I: INVERSE: PRINT A$: NORMAL: GOTO 41

49 WT% = WT% - C: IF WT% < 0 THEN 52
50 AX$(A,P) =  LEFT$ (A$ + " ", LEN (A$)): IF P=15 OR WT%<50 THEN 25000
51 HTAB 1: VTAB P+3: PRINT LEFT$(AX$(A,P),14);: P = P + 1: GOTO 41

52 PRINT : PRINT "NOT ENOUGH MAGIC UNITS! ";: GOSUB 68: WT% = WT% + C: GOTO 40

53 HOME: VTAB 21: PRINT "WHO WILL TRANSACT (#) ";: GET A$: IF A$ = CHR$(27) THEN POP: GOTO 25001
54 A =  VAL (A$) - 1: IF A<0 OR A>3 THEN 53
55 IF AB%(A) = 0 THEN A$ = NM$(A)+" IS DEAD! ": GOTO 99
56 IF CL$(A) <> "WIZARD" AND CL$(A) <> "RANGER" THEN A$ = "NOT A WIZARD OR RANGER. ": GOTO 99
57 C = (10 +  INT (ZA%(A) / 1000) * 8) * (1 - AK%(A) / 100)
58 PRINT: PRINT "LIBRARY COSTS ";INT(C);" GOLD, OK? (Y/N) ";: GET A$: IF A$ <> "Y" THEN POP: GOTO 25001
59 AD% = AD% - C
60 IF AD% < 0 THEN AD% = AD% + C: A$ = "YOU DON'T HAVE THE GOLD! ": GOTO 99
61 RETURN

62 HTAB 1: VTAB 21: PRINT "(R)ESET OR (L)EAVE WITH UNSPENT M.U.: ";: GET A$
63 IF A$ = "R" THEN 33
64 IF A$ = "L" THEN 25000
65 GOTO 62

68 POKE 6,50: POKE 7,25: POKE 8,1: POKE 9,1: POKE 30,1: CALL 852: GET A$: RETURN

99 POP: HOME: VTAB 21: PRINT A$;: GOSUB 68: GOTO 25001

8900 GOSUB 53: GOTO 33

25000 DR%(A,2) = 0: DX$(A) = AX$(A,0): IF DX$(A) = "" THEN DX$(A) = AX$(A,16): DR%(A,2) = 16
25001 L=1: POKE -16304,0: POKE 16384,0: POKE 103,1: POKE 104,64: GOTO 25000
