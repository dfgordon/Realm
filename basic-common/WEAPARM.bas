10  ON I GOTO 11,12,13,14,15,16,17,18,19,20,21,22,23
11 C = 30: B$ = "DAGGER": RETURN
12 C = 80: B$ = "AXE": RETURN
13 C = 80: B$ = "MACE": RETURN
14 C = 100: B$ = "MORNING STAR": RETURN
15 C = 120: B$ = "BOW": RETURN
16 C = 200: B$ = "LONGSWORD": RETURN
17 C = 300: B$ = "BATTLEAXE": RETURN
18 C = 340: B$ = "BROADSWORD": RETURN
19 C = 500: B$ = "2H SWORD": RETURN
20 C = 2000: B$ = "SWORD OF LIGHT": RETURN
21 C = 90: B$ = "LEATHER": RETURN
22 C = 180: B$ = "CHAIN": RETURN
23 C = 400: B$ = "PLATE": RETURN

4210  PRINT NM$(A);"'S ITEMS:": FOR I = 0 TO 7: PRINT I + 1;") ";: PRINT AP$(A,I): NEXT: RETURN

4300  PRINT "FOR SALE:"
4310  P = 1: N = 9: IF MA = 15 THEN P = 11: N = 13
4320  IF T$="SULPHUR CITY" AND MA = 10 THEN P = 1: N = 10
4330  FOR I = P TO N: GOSUB 10: GOSUB 19000: NORMAL: IF I=P THEN INVERSE
4340  PRINT B$;: NORMAL: PRINT " (";C;")": NEXT: RETURN

4400  N = 99: IF A$ = CHR$(8) THEN A = A - 1: IF A<0 THEN A = 3
4410  IF A$ = CHR$(21) THEN A = A + 1: IF A>3 THEN A = 0
4420  IF A$ = "A" OR A$ = CHR$(11) THEN N = M: M = M - 1: IF M<0 THEN M = P
4430  IF A$ = "Z" OR A$ = CHR$(10) THEN N = M: M = M + 1: IF M>P THEN M = 0
4440  RETURN

4450  HTAB 1: VTAB I+9: PRINT "LR-ARROWS=CHARACTER, ENTER=PLACE": PRINT "UD-ARROWS/A/Z=SLOT, ESC=CANCEL"
4460  HTAB 4: VTAB N+I: PRINT AP$(A,N);" ": INVERSE: HTAB 4: VTAB M+I: PRINT AP$(A,M);" ": NORMAL
4461  HTAB 34: VTAB I+10: GET A$: IF A$ = CHR$(27) THEN M = 999: RETURN
4470  IF A$ = CHR$(13) THEN RETURN
4480  GOSUB 4400: IF N = 99 THEN M = 99: RETURN
4490  GOTO 4460

4600  TEXT: HOME: PRINT "PLACING: ";B$: PRINT: GOSUB 4210: M = 0: N = 0: P = 7: I = 4: GOSUB 4450: IF M = 999 THEN PRINT: PRINT "SALE ABORTED! ";: GET A$: RETURN
4610  IF M = 99 THEN 4600
4620  IF AP$(A,M) = "" THEN 4650
4630  HOME: PRINT "REPLACE ";AP$(A,M);" (Y/N) ? ";: GET A$: IF A$ <> "Y" AND A$ <> "N" THEN 4630
4640  IF A$ = "N" THEN 4600
4650  AP$(A,M) =  LEFT$ (B$ + " ", LEN (B$)): AD% = AD% - C: RETURN

8900  MA = M
9510  TEXT: HOME: PRINT "WELCOME TO THE ";
9511  IF MA = 10 THEN PRINT "WEAPONS SHOP!"
9512  IF MA = 15 THEN PRINT "ARMOURY!"
9520  PRINT: GOSUB 4300: I = P
9530  HTAB 1: VTAB 6+N-P: PRINT "GOLD: ";AD%;"- ARROWS, ENTER, ESC: ";: GET A$: IF A$ = CHR$(27) THEN 25000
9540  L = 0: IF A$ = CHR$(13) THEN GOSUB 10: GOSUB 19000: GOTO 9560
9550  IF A$ = CHR$(8) OR A$ = CHR$(11) THEN L = -1
9551  IF A$ = CHR$(10) OR A$ = CHR$(21) THEN L = 1
9552  GOSUB 10: HTAB 1: VTAB 4+I-P: PRINT B$: I = I + L
9553  IF I<P THEN I=N
9554  IF I>N THEN I=P
9555  GOSUB 10: HTAB 1: VTAB 4+I-P: INVERSE: PRINT B$: NORMAL: GOTO 9530

9560  IF AD% < C THEN PRINT: PRINT "YOU DON'T HAVE THE GOLD! ";: GOSUB 30050: GOTO 9510
9670  A = 0: GOSUB 4600: GOTO 9510

19000 C = INT (C * (1 - (AK%(0)+AK%(1)+AK%(2)+AK%(3)) / 400)): RETURN

25000  L=1: POKE -16304,0: POKE 16384,0: POKE 103,1: POKE 104,64: GOTO 25000

30050  POKE 6,50: POKE 7,25: POKE 8,1: POKE 9,1: POKE 30,1: CALL 852: GET A$: RETURN
