 10 M = FRE(0)
 20 IF PG$="TOWN" THEN 100
 22 IF PG$="OUTSIDE" THEN 300
 24 IF PG$="DUNGEON" THEN 500
 25 IF PG$="COMBAT" THEN 600

 100  ONERR GOTO 9000: PRINT
 110  IF R%=1 THEN 160
 115  IF MD%=1 THEN PRINT CHR$(4);"BSAVE PARTIES/";LEFT$(RM$,2);".";NA$;",A$6E00,L3200": MD% = 0
 120  IF RM$ = "ARRINEA" THEN PRINT CHR$(4);"BLOAD MAPS/TOWNPIC.";X;".";Y;",A$6E00"
 121  IF RM$ <> "ARRINEA" THEN PRINT CHR$(4);"BLOAD XMAPS/TOWNPIC.";X;".";Y;",A$6E00"
 130  I = 28960 : GOSUB 8000
 140  PRINT CHR$(4);"BLOAD BIN/TWNSPS"
 150  PRINT CHR$(4);"BLOAD BIN/TOWN.INTRP2"
 151  POKE 6519,110: POKE 6558,110: POKE 6577,110: POKE 6608,110: POKE 7039,110: POKE 7117,110: POKE 7231,110: POKE 8166,110
 152  POKE 6460,113: POKE 7137,113: POKE 7197,113: POKE 7318,113: POKE 7342,113: POKE 8155,113
 153  POKE 7491,116: POKE 6117,102
 160  PRINT CHR$(4);"BLOAD PROG/";PG$
 170  POKE 216,0: IF R%=1 THEN 190
 180  POKE 16384,0: POKE 103,1: POKE 104,64: GOTO 0
 190  POKE 16384,0: POKE 103,1: POKE 104,64: GOTO 10

 300  ONERR GOTO 9000: PRINT
 310  PRINT CHR$(4);"BLOAD PARTIES/";LEFT$(RM$,2);".";NA$
 330  PRINT CHR$(4);"BLOAD PROG/";PG$
 340  POKE 216,0: POKE 16384,0: POKE 103,1: POKE 104,64: GOTO 3

 500  ONERR GOTO 9000: PRINT
 501  IF R%=1 THEN 580
 502  IF R%=2 OR MD%=0 THEN 530
 520  PRINT CHR$(4);"BSAVE PARTIES/";LEFT$(RM$,2);".";NA$;",A$6E00,L3200": MD% = 0
 530  PRINT CHR$(4);"BLOAD XMAPS/DNGPIC.";X;".";Y;",A$6E00"
 540  I = 30160 : GOSUB 8000
 560  PRINT CHR$(4);"BLOAD BIN/DNGNSPS"
 570  PRINT CHR$(4);"BLOAD BIN/DNGN.INTRP"
 571  POKE 6519,110: POKE 6558,110: POKE 6577,110: POKE 6608,110: POKE 7039,110: POKE 7117,110
 572  POKE 7134,110: POKE 7158,110: POKE 7314,110: POKE 7542,110: POKE 7590,110: POKE 7690,110
 573  POKE 7738,110: POKE 7805,110: POKE 7849,110: POKE 7916,110: POKE 7985,110: POKE 8010,110
 574  POKE 8042,110: POKE 8064,110: POKE 7368,90: POKE 8157,90: POKE 8165,94
 580  PRINT CHR$(4);"BLOAD PROG/";PG$
 585  POKE 216,0: IF R%=1 THEN 595
 590  POKE 16384,0: POKE 103,1: POKE 104,64: GOTO 0
 595  POKE 16384,0: POKE 103,1: POKE 104,64: GOTO 10

 600  ONERR GOTO 9000: PRINT
 620  PRINT CHR$(4);"BLOAD PROG/COMBAT"
 630  POKE 216,0: POKE 16384,0: POKE 103,1: POKE 104,64: GOTO 10

 8000  B$ = ""
 8010  IF  PEEK (I) = 0 THEN 8030
 8020  B$ = B$ +  CHR$ ( PEEK (I)):I = I + 1: GOTO 8010
 8030  A = (40 -  LEN (B$)) / 2: HOME : VTAB 21
 8040  PRINT  TAB( A);B$: FOR P = 0 TO EP: NEXT P
 8050  RETURN

 9000  REM ERROR HANDLER
 9200  HOME: VTAB 21: PRINT "PLEASE INSERT DISK- ";: GET A$
 9210  CALL 938: PRINT : RESUME
